<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactieve Nederlands Studietool</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
        }
        /* Custom styles for flashcard flip effect */
        .flashcard-container {
            perspective: 1000px;
        }
        .flashcard {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }
        .flashcard.is-flipped {
            transform: rotateY(180deg);
        }
        .flashcard-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            text-align: center;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .flashcard-front {
            background-color: #bfdbfe; /* blue-200 */
            color: #1e40af; /* blue-800 */
            z-index: 2;
        }
        .flashcard-back {
            background-color: #93c5fd; /* blue-300 */
            color: #1e40af; /* blue-800 */
            transform: rotateY(180deg);
            z-index: 1;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-white shadow-sm py-6">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-800">Interactieve Nederlands Studietool</h1>
            <p class="text-gray-600 mt-2">Jouw persoonlijke hulpmiddel om Nederlandse notities onder de knie te krijgen</p>
        </div>
    </header>

    <nav class="bg-blue-700 p-4 rounded-b-lg shadow-md mb-8 max-w-4xl mx-auto px-4">
        <ul class="flex flex-wrap justify-center gap-4">
            <li><button id="nav-home" class="px-4 py-2 rounded-lg font-semibold transition-colors duration-200 bg-blue-900 text-white hover:bg-blue-800">Home</button></li>
            <li><button id="nav-vocabulary" class="px-4 py-2 rounded-lg font-semibold transition-colors duration-200 bg-blue-600 text-blue-100 hover:bg-blue-800">Woordenschat</button></li>
            <li><button id="nav-grammar" class="px-4 py-2 rounded-lg font-semibold transition-colors duration-200 bg-blue-600 text-blue-100 hover:bg-blue-800">Grammatica</button></li>
            <li><button id="nav-flashcards" class="px-4 py-2 rounded-lg font-semibold transition-colors duration-200 bg-blue-600 text-blue-100 hover:bg-blue-800">Flashcards</button></li>
            <li><button id="nav-quiz" class="px-4 py-2 rounded-lg font-semibold transition-colors duration-200 bg-blue-600 text-blue-100 hover:bg-blue-800">Quiz</button></li>
        </ul>
    </nav>

    <main class="max-w-4xl mx-auto px-4 my-8">
        <!-- Home View -->
        <section id="view-home" class="p-8 bg-white rounded-lg shadow-md text-center">
            <h2 class="text-3xl font-bold text-blue-700 mb-4">Welkom bij jouw Nederlandse Studietool!</h2>
            <p class="text-gray-700 mb-6">
                Gebruik de navigatie hierboven om je woordenschat te verkennen, grammaticaregels te herhalen, te oefenen met flashcards of je kennis te testen met een quiz.
            </p>
            <div class="flex flex-col md:flex-row justify-center gap-4">
                <button id="home-start-flashcards" class="bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-green-600 transition-colors duration-300 transform hover:scale-105">Start Flashcards</button>
                <button id="home-start-quiz" class="bg-purple-500 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-purple-600 transition-colors duration-300 transform hover:scale-105">Start Quiz</button>
            </div>
        </section>

        <!-- Vocabulary View -->
        <section id="view-vocabulary" class="hidden p-8 bg-white rounded-lg shadow-md">
            <h2 class="text-2xl font-bold text-blue-700 mb-6 border-b pb-2">1. Woordenschat (Vocabulary)</h2>

            <h3 class="text-xl font-semibold text-gray-700 mb-4">1.1 De-woorden (Common Nouns)</h3>
            <ul id="de-words-list" class="list-disc list-inside ml-4 mb-6 text-gray-700 grid grid-cols-1 md:grid-cols-2 gap-2"></ul>

            <h3 class="text-xl font-semibold text-gray-700 mb-4">1.2 Het-woorden (Neuter Nouns)</h3>
            <ul id="het-words-list" class="list-disc list-inside ml-4 mb-6 text-gray-700 grid grid-cols-1 md:grid-cols-2 gap-2"></ul>

            <h3 class="text-xl font-semibold text-gray-700 mb-4">1.3 Bijvoeglijke naamwoorden & Bijwoorden (Adjectives & Adverbs)</h3>
            <ul id="adjectives-adverbs-list" class="list-disc list-inside ml-4 mb-6 text-gray-700 grid grid-cols-1 md:grid-cols-2 gap-2"></ul>

            <h3 class="text-xl font-semibold text-gray-700 mb-4">1.4 Werkwoorden (Verbs)</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white rounded-lg shadow-sm">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="py-2 px-4 border-b border-gray-200 text-left text-sm font-semibold text-gray-600">Infinitief</th>
                            <th class="py-2 px-4 border-b border-gray-200 text-left text-sm font-semibold text-gray-600">Tegenwoordige Tijd (TT)</th>
                            <th class="py-2 px-4 border-b border-gray-200 text-left text-sm font-semibold text-gray-600">Verleden Tijd (VT) / Voltooid Deelwoord (VD)</th>
                            <th class="py-2 px-4 border-b border-gray-200 text-left text-sm font-semibold text-gray-600">Vertaling (basis)</th>
                        </tr>
                    </thead>
                    <tbody id="verbs-table-body"></tbody>
                </table>
            </div>
        </section>

        <!-- Grammar View -->
        <section id="view-grammar" class="hidden p-8 bg-white rounded-lg shadow-md">
            <h2 class="text-2xl font-bold text-blue-700 mb-6 border-b pb-2">2. Grammatica (Grammar)</h2>
            <div id="grammar-rules-container"></div>
        </section>

        <!-- Flashcards View -->
        <section id="view-flashcards" class="hidden p-8 bg-white rounded-lg shadow-md flex flex-col items-center">
            <h2 class="text-2xl font-bold text-blue-700 mb-6">Flashcards</h2>
            <div id="flashcard-display" class="flashcard-container w-full max-w-md h-64">
                <div class="flashcard w-full h-full">
                    <div class="flashcard-face flashcard-front text-2xl font-semibold"></div>
                    <div class="flashcard-face flashcard-back text-xl font-medium"></div>
                </div>
            </div>
            <div class="mt-6 flex gap-4">
                <button id="flashcard-prev" class="bg-gray-300 text-gray-800 px-5 py-2 rounded-lg shadow-md hover:bg-gray-400 transition-colors duration-200">Vorige</button>
                <button id="flashcard-next" class="bg-blue-500 text-white px-5 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-200">Volgende</button>
            </div>
            <p id="flashcard-counter" class="mt-4 text-gray-600"></p>
        </section>

        <!-- Quiz View -->
        <section id="view-quiz" class="hidden p-8 bg-white rounded-lg shadow-md flex flex-col items-center">
            <div id="quiz-start-screen" class="text-center">
                <h2 class="text-2xl font-bold text-purple-700 mb-4">Klaar voor de Quiz?</h2>
                <p class="text-gray-700 mb-6">Test je kennis van woordenschat en grammatica.</p>
                <button id="quiz-start-button" class="bg-purple-500 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-purple-600 transition-colors duration-300 transform hover:scale-105">Start Quiz</button>
            </div>

            <div id="quiz-question-screen" class="hidden w-full max-w-lg">
                <p class="text-lg font-semibold text-gray-800 mb-4">Vraag <span id="question-number"></span> van <span id="total-questions"></span>:</p>
                <p id="quiz-question-text" class="text-xl text-blue-800 mb-6"></p>
                <div id="quiz-options-container" class="grid grid-cols-1 gap-4 mb-6"></div>
                <p id="quiz-feedback" class="text-center text-lg font-semibold mb-4"></p>
                <button id="quiz-next-button" class="w-full bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-blue-600 transition-colors duration-300 transform hover:scale-105 opacity-50 cursor-not-allowed" disabled>Volgende Vraag</button>
            </div>

            <div id="quiz-result-screen" class="hidden text-center">
                <h2 class="text-3xl font-bold text-purple-700 mb-4">Quiz Voltooid!</h2>
                <p id="quiz-score-text" class="text-xl text-gray-700 mb-6"></p>
                <button id="quiz-restart-button" class="bg-purple-500 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-purple-600 transition-colors duration-300 transform hover:scale-105">Herstart Quiz</button>
            </div>
        </section>
    </main>

    <script>
        // --- Study Data (Copied from your notes) ---
        const studyData = {
            vocabulary: {
                deWords: [
                    { word: 'de gym', translation: 'the gym' },
                    { word: 'de zomer', translation: 'the summer' },
                    { word: 'de reden', translation: 'the reason' },
                    { word: 'de stok achter de deur', translation: 'the motivation/pressure to finish something' },
                    { word: 'de beurt', translation: 'the turn' },
                    { word: 'de verjaardagstaart', translation: 'the birthday cake' },
                    { word: 'de lievelingstaart', translation: 'the favorite cake' },
                    { word: 'de fotograaf', translation: 'the photographer' },
                    { word: 'de situatie', translation: 'the situation' },
                    { word: 'de dreiging', translation: 'the threat' },
                    { word: 'de inbraak', translation: 'the burglary' },
                    { word: 'de staart', translation: 'the tail (of the whale)' },
                    { word: 'de vinnen', translation: 'the fins (of the whale)' },
                    { word: 'de apotheker', translation: 'the pharmacist' },
                    { word: 'de slagerij', translation: 'the butcher’s shop' },
                    { word: 'de wasmachine', translation: 'the washing machine' },
                    { word: 'de waarheid', translation: 'the truth' },
                    { word: 'de vooruitgang', translation: 'the progress' },
                    { word: 'de wet', translation: 'the law' },
                    { word: 'de peetmoeder', translation: 'the godmother' },
                    { word: 'de basisschool', translation: 'the primary school' },
                    { word: 'de toets', translation: 'the test' },
                    { word: 'de halte', translation: 'the stop (bus/tram)' },
                    { word: 'de mevrouw', translation: 'the madam' },
                    { word: 'de trein', translation: 'the train' },
                    { word: 'de taakverdeling', translation: 'the division of tasks' },
                    { word: 'de ongesteldheid', translation: 'the menstruation' },
                    { word: 'de middelbare school', translation: 'the secondary school' },
                    { word: 'de opleiding', translation: 'the education/training' },
                    { word: 'de universiteit', translation: 'the university' },
                    { word: 'de trouwerij', translation: 'the wedding' },
                    { word: 'de hardloopwedstrijd', translation: 'the running race' },
                    { word: 'de waterpistolen', translation: 'the water pistols' },
                    { word: 'de rolschaatsen', translation: 'the roller skates' },
                    { word: 'de koorts', translation: 'the fever' },
                    { word: 'de diarree', translation: 'the diarrhea' },
                    { word: 'de dienstregeling', translation: 'the timetable' },
                    { word: 'de huisbaas', translation: 'the landlord' },
                    { word: 'de gewoonte', translation: 'the habit' },
                    { word: 'de kennis', translation: 'the knowledge' },
                    { word: 'de vriendschap', translation: 'the friendship' },
                    { word: 'de conditie', translation: 'the condition' },
                    { word: 'de filosofie', translation: 'the philosophy' },
                    { word: 'de organisatie', translation: 'the organization' },
                    { word: 'de politie', translation: 'the police' },
                    { word: 'de lamellen', translation: 'the blinds' },
                    { word: 'de gordijn', translation: 'the curtain' },
                    { word: 'de kaars', translation: 'the candle' },
                    { word: 'de oplader', translation: 'the charger' },
                    { word: 'de bikini', translation: 'the bikini' },
                    { word: 'de windkracht', translation: 'the wind force' },
                    { word: 'de bliksem', translation: 'the lightning' },
                    { word: 'de wolken', translation: 'the clouds' },
                    { word: 'de injectie', translation: 'the injection' },
                    { word: 'de operatie', translation: 'the operation' },
                    { word: 'de oplossing', translation: 'the solution' },
                    { word: 'de textuur', translation: 'the texture' },
                    { word: 'de kritiek', translation: 'the criticism' },
                    { word: 'de rij', translation: 'the queue' },
                    { word: 'de meneer', translation: 'the mister' },
                    { word: 'de steegjes', translation: 'the alleys' },
                    { word: 'de motor', translation: 'the motorcycle' },
                    { word: 'de man', translation: 'the man' },
                    { word: 'de winkels', translation: 'the shops' },
                    { word: 'de spieren', translation: 'the muscles' },
                    { word: 'de ruggengraat', translation: 'the spine' },
                    { word: 'de walvis', translation: 'the whale' },
                ],
                hetWords: [
                    { word: 'het huis', translation: 'the house' },
                    { word: 'het appartement', translation: 'the apartment' },
                    { word: 'het probleem', translation: 'the problem' },
                    { word: 'het huiswerk', translation: 'the homework' },
                    { word: 'het examen', translation: 'the exam' },
                    { word: 'het horloge', translation: 'the watch' },
                    { word: 'het station', translation: 'the station' },
                    { word: 'het kunstwerk', translation: 'the artwork' },
                    { word: 'het schilderij', translation: 'the painting' },
                    { word: 'het tekening', translation: 'the drawing' },
                    { word: 'het gemeentehuis', translation: 'the town hall' },
                    { word: 'het waterijs', translation: 'the popsicle' },
                    { word: 'het thuis', translation: 'the home' },
                    { word: 'het onweer', translation: 'the thunderstorm' },
                    { word: 'het spoor', translation: 'the track/rail' },
                    { word: 'het paspoort', translation: 'the passport' },
                    { word: 'het gebouw', translation: 'the building' },
                    { word: 'het geluid', translation: 'the sound' },
                    { word: 'het toerisme', translation: 'the tourism' },
                    { word: 'het arrangement', translation: 'the arrangement' },
                    { word: 'het stelsel', translation: 'the system' },
                    { word: 'het museum', translation: 'the museum' },
                    { word: 'het strand', translation: 'the beach' },
                    { word: 'het identiteitsbewijs', translation: 'the ID' },
                    { word: 'het huurhuis', translation: 'the rental house' },
                    { word: 'het klushuis', translation: 'the fixer-upper house' },
                    { word: 'het zandstrand', translation: 'the sandy beach' },
                    { word: 'het stenen strand', translation: 'the stony beach' },
                    { word: 'het water', translation: 'the water' },
                    { word: 'het herstel', translation: 'the recovery' },
                    { word: 'het klimaat', translation: 'the climate' },
                    { word: 'het haar', translation: 'the hair' },
                ],
                adjectivesAdverbs: [
                    { word: 'zelfverzekerd', translation: 'confident' },
                    { word: 'bijzonder', translation: 'special, particular' },
                    { word: 'ontroerend', translation: 'touching, moving (emotionally)' },
                    { word: 'verdrietig', translation: 'sad' },
                    { word: 'blij', translation: 'happy' },
                    { word: 'bezorgd', translation: 'worried' },
                    { word: 'middelmatig', translation: 'mediocre' },
                    { word: 'vreedzaam', translation: 'peaceful (without violence)' },
                    { word: 'indrukwekkend', translation: 'impressive' },
                    { word: 'zelden', translation: 'rarely' },
                    { word: 'meerdere keren / herhaaldelijk', translation: 'multiple times' },
                    { word: 'misselijk', translation: 'nauseous (as if you have to vomit)' },
                    { word: 'verlegen', translation: 'shy' },
                    { word: 'besmettelijk', translation: 'contagious' },
                    { word: 'verloren', translation: 'lost' },
                    { word: 'kwijt', translation: 'lost (adj) / kwijt zijn (to have lost something)' },
                    { word: 'ontspannend', translation: 'relaxing' },
                    { word: 'zonnig', translation: 'sunny' },
                    { word: 'bewolkt', translation: 'cloudy' },
                    { word: 'nat', translation: 'wet (snow)' },
                    { word: 'afwisselend', translation: 'alternating (weather)' },
                    { word: 'tropisch', translation: 'tropical' },
                    { word: 'benauwd', translation: 'stuffy / breathless' },
                    { word: 'nauwe', translation: 'narrow (alleys)' },
                    { word: 'snel', translation: 'fast (go ahead)' },
                    { word: 'netjes', translation: 'neatly (in line)' },
                    { word: 'glad', translation: 'slippery' },
                    { word: 'erg', translation: 'very' },
                    { word: 'erger', translation: 'worse' },
                    { word: 'teleurgesteld', translation: 'disappointed' },
                ],
                verbs: [
                    { infinitive: 'bolderen', tt: 'Ik bolder', vt_vd: 'Ik bolderde / Ik heb gebolderd', translation: 'to rumble / to boom' },
                    { infinitive: 'doorgaan', tt: 'Ik ga door', vt_vd: 'Ik ging door / Ik ben doorgegaan', translation: 'to continue' },
                    { infinitive: 'helpen', tt: 'Ik help', vt_vd: 'Ik hielp / Ik heb geholpen', translation: 'to help' },
                    { infinitive: 'vieren', tt: 'Ik vier', vt_vd: 'Ik vierde / Ik heb gevierd', translation: 'to celebrate' },
                    { infinitive: 'bakken', tt: 'Ik bak', vt_vd: 'Ik bakte / Ik heb gebakken', translation: 'to bake' },
                    { infinitive: 'maken', tt: 'Ik maak', vt_vd: 'Ik maakte / Ik heb gemaakt', translation: 'to make' },
                    { infinitive: 'zakken', tt: 'Ik zak', vt_vd: 'Ik zakte / Ik ben gezakt', translation: 'to fail (exam)' },
                    { infinitive: 'slagen', tt: 'Ik slaag', vt_vd: 'Ik slaagde / Ik ben geslaagd', translation: 'to succeed (exam)' },
                    { infinitive: 'vasthouden', tt: 'Ik houd vast', vt_vd: 'Ik hield vast / Ik heb vastgehouden', translation: 'to hold' },
                    { infinitive: 'raken (emotioneel)', tt: 'De foto raakt me', vt_vd: 'De foto raakte me / De foto heeft me geraakt', translation: 'to affect emotionally' },
                    { infinitive: 'aanraken (fysiek)', tt: 'Ik raak aan', vt_vd: 'Ik raakte aan / Ik heb aangeraakt', translation: 'to touch (physically)' },
                    { infinitive: 'regelen', tt: 'Ik regel', vt_vd: 'Ik regelde / Ik heb geregeld', translation: 'to arrange, fix' },
                    { infinitive: 'bezoeken', tt: 'Ik bezoek', vt_vd: 'Ik bezocht / Ik heb bezocht', translation: 'to visit' },
                    { infinitive: 'bekijken', tt: 'Ik bekijk', vt_vd: 'Ik bekeek / Ik heb bekeken', translation: 'to look at, view' },
                    { infinitive: 'moeten', tt: 'Ik moet', vt_vd: 'Ik moest', translation: 'must, had to' },
                    { infinitive: 'vergeten', tt: 'Ik vergeet', vt_vd: 'Ik vergat / Ik ben vergeten', translation: 'to forget' },
                    { infinitive: 'klussen', tt: 'Ik klus', vt_vd: 'Ik kluste / Ik heb geklust', translation: 'to do repairs/DIY' },
                    { infinitive: 'doen (klusjes)', tt: 'Ik doe klusjes', vt_vd: 'Ik deed klusjes / Ik heb klusjes gedaan', translation: 'to do chores' },
                    { infinitive: 'ophangen', tt: 'Ik hang op', vt_vd: 'Ik hing op / Ik heb opgehangen', translation: 'to hang up' },
                    { infinitive: 'opzoeken', tt: 'Ik zoek op', vt_vd: 'Ik zocht op / Ik heb opgezocht', translation: 'to look up (information)' },
                    { infinitive: 'staren', tt: 'Ik staar', vt_vd: 'Ik staarde / Ik heb gestaard', translation: 'to stare' },
                    { infinitive: 'in elkaar zetten', tt: 'Ik zet in elkaar', vt_vd: 'Ik zette in elkaar / Ik heb in elkaar gezet', translation: 'to assemble' },
                    { infinitive: 'vastmaken', tt: 'Ik maak vast', vt_vd: 'Ik maakte vast / Ik heb vastgemaakt', translation: 'to fasten' },
                    { infinitive: 'verwijzen', tt: 'Ik verwijs', vt_vd: 'Ik verwees / Ik heb verwezen', translation: 'to refer' },
                    { infinitive: 'schelen', tt: 'Het scheelt', vt_vd: 'Het scheelde / Het heeft gescheeld', translation: 'to save (time), make a difference' },
                    { infinitive: 'vallen', tt: 'Ik val', vt_vd: 'Ik viel / Ik ben gevallen', translation: 'to fall' },
                    { infinitive: 'wassen', tt: 'Ik was', vt_vd: 'Ik waste / Ik heb gewassen', translation: 'to wash' },
                    { infinitive: 'vervelen (zich)', tt: 'Ik verveel me', vt_vd: 'Ik verveelde me / Ik heb me verveeld', translation: 'to be bored' },
                    { infinitive: 'bezeren (zich)', tt: 'Ik bezeer me', vt_vd: 'Ik bezeerde me / Ik heb me bezeerd', translation: 'to hurt oneself' },
                    { infinitive: 'schamen (zich)', tt: 'Ik schaam me', vt_vd: 'Ik schaamde me / Ik heb me geschaamd', translation: 'to be ashamed' },
                    { infinitive: 'voelen', tt: 'Ik voel me', vt_vd: 'Ik voelde me / Ik heb me gevoeld', translation: 'to feel' },
                    { infinitive: 'studeren', tt: 'Ik studeer', vt_vd: 'Ik studeerde / Ik heb gestudeerd', translation: 'to study' },
                    { infinitive: 'kijken', tt: 'Ik kijk', vt_vd: 'Ik keek / Ik heb gekeken', translation: 'to watch' },
                    { infinitive: 'halen', tt: 'Ik haal', vt_vd: 'Ik haalde / Ik heb gehaald', translation: 'to get' },
                    { infinitive: 'kuchen', tt: 'Ik kuch', vt_vd: 'Ik kuchte / Ik heb gekucht', translation: 'to cough' },
                    { infinitive: 'overgeven', tt: 'Ik geef over', vt_vd: 'Ik gaf over / Ik heb overgegeven', translation: 'to vomit' },
                    { infinitive: 'zweten', tt: 'Ik zweet', vt_vd: 'Ik zweette / Ik heb gezweet', translation: 'to sweat' },
                    { infinitive: 'doorzetten', tt: 'Ik zet door', vt_vd: 'Ik zette door / Ik heb doorgezet', translation: 'to persevere / to push through' },
                    { infinitive: 'kwijt raken', tt: 'Ik raak kwijt', vt_vd: 'Ik raakte kwijt / Ik ben kwijtgeraakt', translation: 'to lose (something)' },
                    { infinitive: 'vinden', tt: 'Ik vind', vt_vd: 'Ik vond / Ik heb gevonden', translation: 'to find' },
                    { infinitive: 'zonnebrand opdoen', tt: 'Ik doe zonnebrand op', vt_vd: 'Ik deed zonnebrand op / Ik heb zonnebrand opgedaan', translation: 'to apply sunscreen' },
                    { infinitive: 'amuseren (zich)', tt: 'Ik amuseer me', vt_vd: 'Ik amuseerde me / Ik heb me geamuseerd', translation: 'to amuse oneself' },
                    { infinitive: 'ontspannen', tt: 'Ik ontspan', vt_vd: 'Ik ontspande / Ik heb ontspannen', translation: 'to relax' },
                    { infinitive: 'vechten', tt: 'Ik vecht', vt_vd: 'Ik vocht / Ik heb gevochten', translation: 'to fight' },
                    { infinitive: 'wisselen', tt: 'Ik wissel', vt_vd: 'Ik wisselde / Ik heb gewisseld', translation: 'to exchange (money)' },
                    { infinitive: 'aangeven', tt: 'Ik geef aan', vt_vd: 'Ik gaf aan / Ik heb aangegeven', translation: 'to hand over / to indicate' },
                    { infinitive: 'verhuizen', tt: 'Ik verhuis', vt_vd: 'Ik verhuisde / Ik ben verhuisd', translation: 'to move house' },
                    { infinitive: 'kopen', tt: 'Ik koop', vt_vd: 'Ik kocht / Ik heb gekocht', translation: 'to buy' },
                    { infinitive: 'regenen', tt: 'Het regent', vt_vd: 'Het regende / Het heeft geregend', translation: 'to rain' },
                    { infinitive: 'miezeren', tt: 'Het miezert', vt_vd: 'Het miezerde / Het heeft gemiezerd', translation: 'to drizzle' },
                    { infinitive: 'schommelen', tt: 'Het schommelt', vt_vd: 'Het schommelde / Het heeft geschommeld', translation: 'to fluctuate / to swing' },
                    { infinitive: 'klimmen', tt: 'Ik klim', vt_vd: 'Ik klom / Ik ben geklommen', translation: 'to climb' },
                    { infinitive: 'proeven', tt: 'Ik proef', vt_vd: 'Ik proefde / Ik heb geproefd', translation: 'to taste' },
                    { infinitive: 'voorgaan', tt: 'Ik ga voor', vt_vd: 'Ik ging voor / Ik ben voorgegaan', translation: 'to go first / to go ahead (in line)' },
                    { infinitive: 'wachten', tt: 'Ik wacht', vt_vd: 'Ik wachtte / Ik heb gewacht', translation: 'to wait' },
                    { infinitive: 'gaan staan', tt: 'Ik ga staan', vt_vd: 'Ik ging staan / Ik ben gaan staan', translation: 'to stand up / to take a stand' },
                    { infinitive: 'aanmaken', tt: 'Ik maak aan', vt_vd: 'Ik maakte aan / Ik heb aangemaakt', translation: 'to create / to make (e.g. a fire)' },
                    { infinitive: 'afwisselen', tt: 'Ik wissel af', vt_vd: 'Ik wisselde af / Ik heb afgewisseld', translation: 'to alternate / to vary' },
                    { infinitive: 'overkomen', tt: 'Het overkomt me', vt_vd: 'Het overkwam me / Het is me overkomen', translation: 'to happen / to come across' },
                    { infinitive: 'leren', tt: 'Ik leer', vt_vd: 'Ik leerde / Ik heb geleerd', translation: 'to learn' },
                    { infinitive: 'snurken', tt: 'Ik snurk', vt_vd: 'Ik snurkte / Ik heb gesnurkt', translation: 'to snore' },
                    { infinitive: 'geven', tt: 'Ik geef', vt_vd: 'Ik gaf / Ik heb gegeven', translation: 'to give' },
                    { infinitive: 'jeuken', tt: 'Het jeukt', vt_vd: 'Het jeukte / Het heeft gejeukt', translation: 'to itch' },
                    { infinitive: 'afdwalen', tt: 'Ik dwaal af', vt_vd: 'Ik dwaalde af / Ik ben afgedwaald', translation: 'to stray / to wander off' },
                    { infinitive: 'verdwalen', tt: 'Ik verdwaal', vt_vd: 'Ik verdwaalde / Ik ben verdwaald', translation: 'to get lost' },
                    { infinitive: 'verliezen', tt: 'Ik verlies', vt_vd: 'Ik verloor / Ik heb verloren', translation: 'to lose' },
                    { infinitive: 'verblijven', tt: 'Ik verblijf', vt_vd: 'Ik verbleef / Ik heb verbleven', translation: 'to stay / to reside' },
                    { infinitive: 'logeren', tt: 'Ik logeer', vt_vd: 'Ik logeerde / Ik heb gelogeerd', translation: 'to lodge / to stay as a guest' },
                ],
            },
            grammar: [
                {
                    rule: 'Lidwoorden (Articles) - Regels & Tips',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li>De meeste zelfstandige naamwoorden zijn <strong>de</strong>-woorden.</li>
                            <li>Verkleinwoorden (eindigend op -je, -tje, -pje, -kje, -etje) zijn <strong>altijd</strong> <strong>het</strong>-woorden.</li>
                            <li>Meervoudige zelfstandige naamwoorden zijn <strong>altijd</strong> <strong>de</strong>-woorden.</li>
                            <li>Zelfstandige naamwoorden die eindigen op specifieke achtervoegsels zijn meestal <strong>de</strong>-woorden:
                                <ul class="list-circle list-inside ml-8">
                                    <li>-ing: de vergadering</li>
                                    <li>-heid: de vrijheid</li>
                                    <li>-nis: de kennis</li>
                                    <li>-schap: de vriendschap</li>
                                    <li>-teit: de universiteit</li>
                                    <li>-tuur: de cultuur</li>
                                    <li>-atie, -tie, -sie, -fie: de organisatie, de conditie, de politie, de filosofie</li>
                                </ul>
                            </li>
                            <li>Zelfstandige naamwoorden die beginnen met "ge-" en niet eindigen op "-e" zijn vaak <strong>het</strong>-woorden:
                                <ul class="list-circle list-inside ml-8">
                                    <li>het gebouw, het geluid</li>
                                </ul>
                            </li>
                            <li>Zelfstandige naamwoorden die eindigen op specifieke achtervoegsels zijn vaak <strong>het</strong>-woorden:
                                <ul class="list-circle list-inside ml-8">
                                    <li>-isme: het toerisme</li>
                                    <li>-ment: het arrangement (maar let op: de argument, de element)</li>
                                    <li>-sel: het stelsel</li>
                                    <li>-um: het museum</li>
                                </ul>
                            </li>
                            <li><strong>Advies:</strong> Leer het lidwoord altijd samen met het zelfstandig naamwoord en exposeer jezelf aan veel Nederlands.</li>
                            <li><strong>Specifiek:</strong> Het station (altijd 'het', nooit 'de').</li>
                            <li><strong>Specifiek:</strong> HET probleem (niet 'de').</li>
                            <li><strong>Specifiek:</strong> HET water (niet 'de').</li>
                            <li><strong>Specifiek:</strong> HET haar (let op: HET lidwoord).</li>
                            <li><strong>Specifiek:</strong> HET klimaat (let op: HET lidwoord).</li>
                        </ul>
                    `
                },
                {
                    rule: '"Om te" + Infinitief',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li>Gebruik <strong>om te</strong> om een <strong>doel</strong> aan te geven.</li>
                            <li>De structuur is: <strong>\`om te\` + infinitief (hele werkwoord)</strong>.</li>
                            <li><strong>Goed:</strong> "Huiswerk helpt <strong>om snel beter te worden</strong>."</li>
                            <li><strong>Goed:</strong> "Ik probeer <strong>om beter te worden</strong>."</li>
                            <li><strong>Fout (correctie):</strong> "Helpen met beter worden" → "Helpen <strong>om beter te worden</strong>."</li>
                        </ul>
                    `
                },
                {
                    rule: 'Werkwoordsvolgorde in bijzinnen (Subordinate Clause Word Order)',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li>In een bijzin (beginnend met voegwoorden zoals \`omdat\`, \`dat\`, \`of\`), verplaatst het <strong>werkwoord naar het einde</strong> van de bijzin.</li>
                            <li><strong>Hoofdzin:</strong> "Ik kan Grieks lezen."</li>
                            <li><strong>Bijzin:</strong> "Omdat ik Grieks <strong>kan lezen</strong>, ..." (het werkwoord \`kan lezen\` staat aan het eind van de bijzin).</li>
                            <li><strong>Voorbeeld:</strong> "Omdat ik <strong>moest klussen</strong>, had ik geen tijd."</li>
                            <li><strong>Specifiek:</strong> "In Libanon <strong>HEBBEN WE</strong>" (correcte volgorde).</li>
                            <li><strong>Specifiek:</strong> "In Nederland <strong>IS ER</strong>" (correcte volgorde).</li>
                        </ul>
                    `
                },
                {
                    rule: 'Correcte Zinsbouw (General Sentence Structure)',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li><strong>Na \`Misschien\` (inversie):</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li><strong>Goed:</strong> "Misschien <strong>heeft hij</strong> honger." (Werkwoord komt direct na \`misschien\`).</li>
                                    <li><strong>Fout:</strong> "Misschien hij heeft honger."</li>
                                </ul>
                            </li>
                            <li><strong>Plaatsing van \`graag\` (na werkwoord):</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li><strong>Voorbeeld:</strong> "Ik wil <strong>graag</strong> structuur aanbrengen."</li>
                                </ul>
                            </li>
                            <li><strong>Zinsdeel voorop:</strong> "En dan <strong>kunnen we</strong>..." (niet "En dan we kunnen").</li>
                            <li><strong>\`kijken of\` vs. \`zien of\`</strong>: Gebruik <strong>kijken of</strong> voor een actie, niet <strong>zien of</strong>. Bijv: "We gaan/kunnen <strong>kijken of</strong> we na de wedstrijd..." (niet "zien om").</li>
                            <li><strong>"En toen..."</strong>: Gebruik voor verhalen in het verleden (niet "en dan").</li>
                            <li><strong>Voltooid deelwoord na hulpwerkwoord:</strong> "Ik was vergeten..." / "Ik kon niet...".</li>
                            <li><strong>Werkwoordsvolgorde bij samengestelde werkwoorden:</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li><strong>Goed:</strong> "Heeft je moeder <strong>taart gebakken</strong>?" (Niet "Heeft je moeder gebakken taart?").</li>
                                </ul>
                            </li>
                        </ul>
                    `
                },
                {
                    rule: '"Kun je" vs. "Kan je"',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li><strong>Formeel / Correct:</strong> "<strong>Kun je</strong>" (bijvoorbeeld: "Kun je langzamer praten?").</li>
                            <li><strong>Informeler / Spreektaal:</strong> "<strong>Kan je</strong>" (vaak gebruikt in de spreektaal, maar minder formeel).</li>
                        </ul>
                    `
                },
                {
                    rule: 'Stamwerkwoord zonder -t bij inversie met "je/jij"',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li><strong>Standaardzin (onderwerp vóór werkwoord):</strong> De stam van het werkwoord krijgt een \`-t\`.
                                <ul class="list-circle list-inside ml-8">
                                    <li>Voorbeeld: "Je <strong>kunt</strong> Nederlands spreken."</li>
                                </ul>
                            </li>
                            <li><strong>Bij inversie (vraag of bijzin, werkwoord vóór onderwerp):</strong> De \`-t\` valt weg wanneer \`je/jij\` direct na het werkwoord staat.
                                <ul class="list-circle list-inside ml-8">
                                    <li>Voorbeeld: "<strong>Kun</strong> je Nederlands spreken?" (Vraag)</li>
                                    <li>Voorbeeld: "Ik vraag of je <strong>kunt</strong>." (Bijzin - \`kunt\` blijft met \`-t\` omdat \`je\` niet direct erna is).</li>
                                </ul>
                            </li>
                            <li><strong>Regel:</strong> Alleen bij \`je/jij\` in de tegenwoordige tijd valt de \`-t\` weg bij inversie. Bij andere onderwerpen (hij/zij/het) blijft de \`-t\` staan (bijv. "Kan hij...?").</li>
                        </ul>
                    `
                },
                {
                    rule: 'Voorzetsels (Prepositions)',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li>Gebruik <strong>"Na"</strong> voor tijd: "Na de les ga ik naar huis."</li>
                            <li>Gebruik <strong>"Vanwege" / "Door"</strong> voor reden/oorzaak: "Vanwege het weer bleven we thuis."</li>
                            <li><strong>Correct:</strong> "Ik heb <strong>naast</strong> mijn man gekucht." (Locatie)</li>
                            <li><strong>Correct:</strong> "Ik ben <strong>op</strong> het strand."</li>
                            <li><strong>Correct:</strong> "<strong>IN</strong> de rij" (niet 'op').</li>
                            <li><strong>Correct:</strong> "<strong>AAN</strong> het wachten" (niet 'in').</li>
                            <li><strong>Posities:</strong> "Ik zit <strong>OP</strong> mijn stoel."</li>
                            <li><strong>Plaats:</strong> "Voor een berg" (In front of a mountain).</li>
                        </ul>
                    `
                },
                {
                    rule: 'Tijdsaanduidingen (Time Indications)',
                    explanation: `
                        <ul class="list-disc list-inside ml-4">
                            <li><strong>Algemeen:</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li>"Vijf jaar geleden"</li>
                                    <li>"Tijdens" (During)</li>
                                    <li>"2.5 uur"</li>
                                </ul>
                            </li>
                            <li><strong>Specifiek:</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li>"Van toen ik klein was"</li>
                                    <li>"De jaren daarna"</li>
                                    <li>"Het derde jaar"</li>
                                    <li>"De eerste twee jaar" (standaard) vs. "De eerste twee jaren" (met nadruk).</li>
                                </ul>
                            </li>
                            <li><strong>Planning:</strong>
                                <ul class="list-circle list-inside ml-8">
                                    <li>"Dat duurt waarschijnlijk maanden."</li>
                                    <li>"Tegen het einde van de picknick..."</li>
                                    <li>"Twee tot zeven ’s avonds."</li>
                                    <li>"Zondagochtend blijf ik thuis."</li>
                                    <li>"Anderhalf uur" (One and a half hours).</li>
                                    <li>"Terwijl" (Whilst / meanwhile).</li>
                                </ul>
                            </li>
                        </ul>
                    `
                },
            ],
            expressions: [
                { phrase: 'De stok achter de deur hebben', explanation: 'motivation/pressure to finish something' },
                { phrase: 'De hort op', explanation: 'Out and about / Away' },
                { phrase: 'Gewoon gaan!', explanation: 'Just go!' },
                { phrase: 'Handig woord', explanation: 'Useful word' },
                { phrase: 'Soms praat ik...', explanation: 'Sometimes I talk...' },
                { phrase: 'Niet helemaal mijn ding', explanation: 'Not really my thing' },
                { phrase: 'Het is helemaal mijn ding', explanation: 'It’s totally my thing' },
                { phrase: 'Let op! / Opletten!', explanation: 'Pay attention!' },
                { phrase: 'Zo, zal ik het lezen.', explanation: 'Well, I’ll read it then. (informal)' },
                { phrase: 'In elke grap zit een kern van waarheid.', explanation: 'In every joke there\'s a grain of truth.' },
                { phrase: 'Uit de hand vallen', explanation: 'to drop from your hand' },
                { phrase: 'Van de tafel vallen', explanation: 'to fall off the table' },
                { phrase: 'Om tijd te besparen…', explanation: 'to save time' },
                { phrase: 'Geen zin in', explanation: 'not in the mood for' },
                { phrase: 'Wat is er aan de hand?', explanation: 'What\'s going on?' },
                { phrase: 'We gaan het zien.', explanation: 'We’ll see / We\'ll wait and see.' },
                { phrase: 'Ik heb zin in...', explanation: 'I feel like...' },
                { phrase: 'Het naar de zin hebben', explanation: 'to amuse oneself' },
                { phrase: 'Toch doen!', explanation: 'Still do it!' },
                { phrase: 'KLOPT', explanation: 'True/Correct' },
                { phrase: 'Heel erg makkelijk', explanation: 'Very easy' },
                { phrase: 'Wie weet...', explanation: 'Who knows...' },
                { phrase: 'Over hebben', explanation: 'left (e.g., "Er is nog 1 bikini over.")' },
                { phrase: 'Net niks', explanation: 'Just about nothing / vrijwel niets' },
                { phrase: 'Dat is balen = O, vervelend zeg! = O, niet fijn…', explanation: 'Too bad / Oh, that\'s annoying / Oh, not nice...' },
                { phrase: 'Iets er weer op hebben zitten', explanation: 'It’s done / it’s over, now, it’s behind you.' },
                { phrase: 'HUIs versus HOUSE', explanation: 'Dutch \'Huis\' versus English \'House\'' },
            ],
            questions: [
                { question: 'Hoe laat is het?', answer: 'What time is it?' },
                { question: 'Ik heb geen idee hoe laat het is.', answer: 'I have no idea what time it is.' },
                { question: 'Mag ik een vraag stellen?', answer: 'May I ask a question?' },
                { question: 'Ik kan je niet volgen.', answer: 'I can\'t follow you. (I don\'t understand you)' },
                { question: 'Kunt u langzamer praten?', answer: 'Can you speak slower? (formal)' },
                { question: 'Kun je langzamer praten?', answer: 'Can you speak slower? (informal)' },
                { question: 'Ga je het vieren?', answer: 'Are you going to celebrate it? (e.g., a birthday)' },
                { question: 'Mag ik u een vraagje stellen?', answer: 'May I ask you a quick question? (formal)' },
                { question: 'Weet u welke halte Spuistraat is?', answer: 'Do you know which stop Spuistraat is?' },
                { question: 'Mevrouw, zou ik u mijn plaats kunnen geven?', answer: 'Madam, could I give you my seat?' },
                { question: 'Zou u op mijn plaats willen zitten?', answer: 'Would you like to sit in my seat?' },
                { question: 'En op welk spoor komt de trein aan?', answer: 'And on which track does the train arrive?' },
                { question: 'Wat is er gebeurd?', answer: 'What happened?' },
                { question: 'Gaat de trein van een ander spoor opeens?', answer: 'Is the train suddenly leaving from a different track?' },
                { question: 'Kunt u me uitleggen wat er gebeurd is?', answer: 'Can you explain to me what happened?' },
                { question: 'Moet ik nog iets over deze medicijnen weten?', answer: 'Do I need to know anything else about these medicines?' },
                { question: 'Was het indrukwekkend?', answer: 'Was it impressive?' },
                { question: 'Hadden wij onweer? Ja, maar niet sterk.', answer: 'Did we have a thunderstorm? Yes, but not strong.' },
                { question: 'Ben je zenuwachtig voor het examen?', answer: 'Are you nervous for the exam?' },
                { question: 'Heb je praktijkexamen of theorie?', answer: 'Do you have a practical exam or theory?' },
                { question: 'Denk je dat je zult slagen of zakken?', answer: 'Do you think you will pass or fail?' },
                { question: 'Sorry, ik kan je niet volgen.', answer: 'Sorry, I can\'t follow you.' },
                { question: 'Kan ik snel voorgaan? Ik heb maar 2 producten.', answer: 'Can I go ahead quickly? I only have 2 products.' },
                { question: 'Sorry, meneer.', answer: 'Sorry, sir.' },
                { question: 'Hoezo sta je opeens hier en niet daar?', answer: 'Why are you suddenly standing here and not there?' },
                { question: 'Mag ik er even langs?', answer: 'May I pass?' },
                { question: 'Mag ik er even tussendoor?', answer: 'May I cut through?' },
                { question: 'Spreek ik Fries?', answer: 'Do I speak Frisian?' },
                { question: 'En als het miezert?', answer: 'And if it drizzles?' },
                { question: 'Kunt u mijn 5 euro wisselen zodat ik 50 cent heb?', answer: 'Can you change my 5 euros so I have 50 cents?' },
                { question: 'Kunt u mij de ketchup aangeven?', answer: 'Can you hand me the ketchup?' },
            ]
        };

        // --- Global Variables for Quiz & Flashcards ---
        let flashcardData = [];
        let shuffledFlashcards = [];
        let currentFlashcardIndex = 0;
        let isFlashcardFlipped = false;

        let quizData = [];
        let shuffledQuizQuestions = [];
        let currentQuizQuestionIndex = 0;
        let quizScore = 0;
        let selectedQuizAnswer = null;
        let quizFeedback = '';

        // --- Helper Functions ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function stripHtml(html) {
            const doc = new DOMParser().parseFromString(html, 'text/html');
            return doc.body.textContent || "";
        }

        // --- View Management ---
        function showView(viewId) {
            document.querySelectorAll('section[id^="view-"]').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(viewId).classList.remove('hidden');

            // Update active navigation button
            document.querySelectorAll('nav button').forEach(button => {
                button.classList.remove('bg-blue-900', 'text-white');
                button.classList.add('bg-blue-600', 'text-blue-100');
            });
            document.getElementById(`nav-${viewId.replace('view-', '')}`).classList.remove('bg-blue-600', 'text-blue-100');
            document.getElementById(`nav-${viewId.replace('view-', '')}`).classList.add('bg-blue-900', 'text-white');

            // Specific view initialization
            if (viewId === 'view-vocabulary') {
                renderVocabulary();
            } else if (viewId === 'view-grammar') {
                renderGrammar();
            } else if (viewId === 'view-flashcards') {
                initFlashcards();
            } else if (viewId === 'view-quiz') {
                initQuiz();
            }
        }

        // --- Render Functions ---
        function renderVocabulary() {
            const deList = document.getElementById('de-words-list');
            deList.innerHTML = '';
            studyData.vocabulary.deWords.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<strong class="text-blue-600">${item.word}</strong>: ${item.translation}`;
                deList.appendChild(li);
            });

            const hetList = document.getElementById('het-words-list');
            hetList.innerHTML = '';
            studyData.vocabulary.hetWords.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<strong class="text-blue-600">${item.word}</strong>: ${item.translation}`;
                hetList.appendChild(li);
            });

            const adjAdvList = document.getElementById('adjectives-adverbs-list');
            adjAdvList.innerHTML = '';
            studyData.vocabulary.adjectivesAdverbs.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${item.word}</strong>: ${item.translation}`;
                adjAdvList.appendChild(li);
            });

            const verbsTableBody = document.getElementById('verbs-table-body');
            verbsTableBody.innerHTML = '';
            studyData.vocabulary.verbs.forEach(item => {
                const tr = document.createElement('tr');
                tr.classList.add('hover:bg-gray-50');
                tr.innerHTML = `
                    <td class="py-2 px-4 border-b border-gray-200">${item.infinitive}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${item.tt}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${item.vt_vd}</td>
                    <td class="py-2 px-4 border-b border-gray-200">${item.translation}</td>
                `;
                verbsTableBody.appendChild(tr);
            });
        }

        function renderGrammar() {
            const grammarContainer = document.getElementById('grammar-rules-container');
            grammarContainer.innerHTML = '';
            studyData.grammar.forEach((rule, index) => {
                const div = document.createElement('div');
                div.classList.add('mb-6', 'pb-4', 'border-b', 'border-gray-100');
                if (index === studyData.grammar.length - 1) {
                    div.classList.remove('border-b');
                }
                div.innerHTML = `
                    <h3 class="text-xl font-semibold text-gray-700 mb-2">${rule.rule}</h3>
                    <div class="text-gray-700">${rule.explanation}</div>
                `;
                grammarContainer.appendChild(div);
            });
        }

        // --- Flashcard Logic ---
        function prepareFlashcardData() {
            const vocabCards = [
                ...studyData.vocabulary.deWords.map(item => ({ front: item.word, back: item.translation, type: 'vocab' })),
                ...studyData.vocabulary.hetWords.map(item => ({ front: item.word, back: item.translation, type: 'vocab' })),
                ...studyData.vocabulary.adjectivesAdverbs.map(item => ({ front: item.word, back: item.translation, type: 'vocab' })),
                ...studyData.vocabulary.verbs.map(item => ({ front: item.infinitive, back: `${item.translation} (TT: ${item.tt}, VT/VD: ${item.vt_vd})`, type: 'verb' }))
            ];

            const grammarCards = studyData.grammar.map(item => ({
                front: item.rule,
                back: stripHtml(item.explanation),
                type: 'grammar'
            }));

            flashcardData = [...vocabCards, ...grammarCards];
        }

        function initFlashcards() {
            prepareFlashcardData();
            shuffledFlashcards = shuffleArray([...flashcardData]);
            currentFlashcardIndex = 0;
            isFlashcardFlipped = false;
            updateFlashcardDisplay();
        }

        function updateFlashcardDisplay() {
            const flashcardElement = document.querySelector('#flashcard-display .flashcard');
            const frontFace = document.querySelector('#flashcard-display .flashcard-front');
            const backFace = document.querySelector('#flashcard-display .flashcard-back');
            const counter = document.getElementById('flashcard-counter');

            if (shuffledFlashcards.length === 0) {
                frontFace.textContent = "Geen flashcards beschikbaar.";
                backFace.textContent = "";
                counter.textContent = "";
                flashcardElement.classList.remove('is-flipped');
                return;
            }

            const currentCard = shuffledFlashcards[currentFlashcardIndex];
            frontFace.textContent = currentCard.front;
            backFace.textContent = currentCard.back;

            flashcardElement.classList.toggle('is-flipped', isFlashcardFlipped);
            counter.textContent = `Kaart ${currentFlashcardIndex + 1} van ${shuffledFlashcards.length}`;
        }

        function flipFlashcard() {
            isFlashcardFlipped = !isFlashcardFlipped;
            updateFlashcardDisplay();
        }

        function nextFlashcard() {
            isFlashcardFlipped = false;
            currentFlashcardIndex = (currentFlashcardIndex + 1) % shuffledFlashcards.length;
            updateFlashcardDisplay();
        }

        function prevFlashcard() {
            isFlashcardFlipped = false;
            currentFlashcardIndex = (currentFlashcardIndex - 1 + shuffledFlashcards.length) % shuffledFlashcards.length;
            updateFlashcardDisplay();
        }

        // --- Quiz Logic ---
        function prepareQuizData() {
            const vocabQuizQuestions = [];
            // Add de-words to quiz
            studyData.vocabulary.deWords.forEach(item => {
                const incorrectOptions = studyData.vocabulary.deWords
                    .filter(w => w.word !== item.word)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(w => w.translation);
                vocabQuizQuestions.push({
                    question: `What is the English translation of "${item.word}"?`,
                    options: shuffleArray([item.translation, ...incorrectOptions]),
                    answer: item.translation
                });
            });
            // Add het-words to quiz
            studyData.vocabulary.hetWords.forEach(item => {
                const incorrectOptions = studyData.vocabulary.hetWords
                    .filter(w => w.word !== item.word)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(w => w.translation);
                vocabQuizQuestions.push({
                    question: `What is the English translation of "${item.word}"?`,
                    options: shuffleArray([item.translation, ...incorrectOptions]),
                    answer: item.translation
                });
            });
            // Add adjectives/adverbs to quiz
            studyData.vocabulary.adjectivesAdverbs.forEach(item => {
                const incorrectOptions = studyData.vocabulary.adjectivesAdverbs
                    .filter(w => w.word !== item.word)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(w => w.translation);
                vocabQuizQuestions.push({
                    question: `What is the English translation of "${item.word}"?`,
                    options: shuffleArray([item.translation, ...incorrectOptions]),
                    answer: item.translation
                });
            });

            // Add some grammar questions (simplified for quiz)
            const grammarQuizQuestions = [
                {
                    question: 'In a Dutch subordinate clause, where does the verb typically go?',
                    options: shuffleArray(['At the beginning', 'In the middle', 'At the end', 'After the subject']),
                    answer: 'At the end'
                },
                {
                    question: 'Which article is always used for diminutives (words ending in -je, -tje, etc.)?',
                    options: shuffleArray(['de', 'het', 'een', 'geen']),
                    answer: 'het'
                },
                {
                    question: 'What is the correct way to say "Maybe he is hungry" (using "misschien")?',
                    options: shuffleArray(['Misschien hij heeft honger.', 'Misschien heeft hij honger.', 'Hij heeft misschien honger.', 'Heeft misschien hij honger.']),
                    answer: 'Misschien heeft hij honger.'
                },
                {
                    question: 'When using "om te" + infinitive, what does it typically indicate?',
                    options: shuffleArray(['A condition', 'A time', 'A purpose', 'A place']),
                    answer: 'A purpose'
                },
                {
                    question: 'Which is the more formal/correct way to ask "Can you speak slower?"',
                    options: shuffleArray(['Kan je langzamer praten?', 'Kun je langzamer praten?']),
                    answer: 'Kun je langzamer praten?'
                },
                {
                    question: 'In "Ik zit OP mijn stoel", what does "OP" indicate?',
                    options: shuffleArray(['Under', 'Next to', 'On', 'Behind']),
                    answer: 'On'
                },
                {
                    question: 'What is the correct article for "probleem"? (het/de)',
                    options: shuffleArray(['de', 'het']),
                    answer: 'het'
                }
            ];

            quizData = shuffleArray([...vocabQuizQuestions, ...grammarQuizQuestions]);
        }

        function initQuiz() {
            prepareQuizData();
            shuffledQuizQuestions = shuffleArray([...quizData]);
            currentQuizQuestionIndex = 0;
            quizScore = 0;
            selectedQuizAnswer = null;
            quizFeedback = '';

            document.getElementById('quiz-start-screen').classList.remove('hidden');
            document.getElementById('quiz-question-screen').classList.add('hidden');
            document.getElementById('quiz-result-screen').classList.add('hidden');
        }

        function startQuiz() {
            document.getElementById('quiz-start-screen').classList.add('hidden');
            document.getElementById('quiz-question-screen').classList.remove('hidden');
            displayQuizQuestion();
        }

        function displayQuizQuestion() {
            const questionTextElem = document.getElementById('quiz-question-text');
            const optionsContainer = document.getElementById('quiz-options-container');
            const questionNumberElem = document.getElementById('question-number');
            const totalQuestionsElem = document.getElementById('total-questions');
            const nextButton = document.getElementById('quiz-next-button');
            const feedbackElem = document.getElementById('quiz-feedback');

            if (shuffledQuizQuestions.length === 0) {
                questionTextElem.textContent = "Geen quizvragen beschikbaar.";
                optionsContainer.innerHTML = '';
                questionNumberElem.textContent = '0';
                totalQuestionsElem.textContent = '0';
                nextButton.disabled = true;
                nextButton.classList.add('opacity-50', 'cursor-not-allowed');
                feedbackElem.textContent = '';
                return;
            }

            const currentQuestion = shuffledQuizQuestions[currentQuizQuestionIndex];
            questionTextElem.textContent = currentQuestion.question;
            questionNumberElem.textContent = currentQuizQuestionIndex + 1;
            totalQuestionsElem.textContent = shuffledQuizQuestions.length;
            optionsContainer.innerHTML = '';
            feedbackElem.textContent = '';
            nextButton.disabled = true;
            nextButton.classList.add('opacity-50', 'cursor-not-allowed');
            selectedQuizAnswer = null;

            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.classList.add('w-full', 'py-3', 'px-4', 'rounded-lg', 'text-lg', 'text-left', 'transition-colors', 'duration-200', 'bg-gray-100', 'hover:bg-gray-200', 'text-gray-800', 'shadow-sm');
                button.textContent = option;
                button.onclick = () => handleQuizAnswer(option, currentQuestion.answer);
                optionsContainer.appendChild(button);
            });
        }

        function handleQuizAnswer(selectedOption, correctAnswer) {
            if (selectedQuizAnswer !== null) return; // Prevent re-answering

            selectedQuizAnswer = selectedOption;
            const options = document.getElementById('quiz-options-container').children;
            const feedbackElem = document.getElementById('quiz-feedback');
            const nextButton = document.getElementById('quiz-next-button');

            if (selectedOption === correctAnswer) {
                quizScore++;
                feedbackElem.textContent = 'Correct!';
                feedbackElem.classList.remove('text-red-600');
                feedbackElem.classList.add('text-green-600');
            } else {
                feedbackElem.textContent = `Incorrect. The correct answer was: ${correctAnswer}`;
                feedbackElem.classList.remove('text-green-600');
                feedbackElem.classList.add('text-red-600');
            }

            // Style options based on correctness
            Array.from(options).forEach(button => {
                if (button.textContent === correctAnswer) {
                    button.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-gray-800');
                    button.classList.add('bg-green-200', 'text-green-800', 'border-2', 'border-green-500');
                } else if (button.textContent === selectedOption) {
                    button.classList.remove('bg-gray-100', 'hover:bg-gray-200', 'text-gray-800');
                    button.classList.add('bg-red-200', 'text-red-800', 'border-2', 'border-red-500');
                } else {
                    button.classList.add('opacity-70', 'cursor-not-allowed');
                }
                button.disabled = true; // Disable all options after selection
            });

            nextButton.disabled = false;
            nextButton.classList.remove('opacity-50', 'cursor-not-allowed');
        }

        function nextQuizQuestion() {
            if (currentQuizQuestionIndex < shuffledQuizQuestions.length - 1) {
                currentQuizQuestionIndex++;
                displayQuizQuestion();
            } else {
                showQuizResult();
            }
        }

        function showQuizResult() {
            document.getElementById('quiz-question-screen').classList.add('hidden');
            document.getElementById('quiz-result-screen').classList.remove('hidden');
            document.getElementById('quiz-score-text').textContent = `Jouw score: ${quizScore} van ${shuffledQuizQuestions.length}`;
        }

        function restartQuiz() {
            initQuiz();
            startQuiz(); // Automatically start a new quiz after restart
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            // Navigation buttons
            document.getElementById('nav-home').addEventListener('click', () => showView('view-home'));
            document.getElementById('nav-vocabulary').addEventListener('click', () => showView('view-vocabulary'));
            document.getElementById('nav-grammar').addEventListener('click', () => showView('view-grammar'));
            document.getElementById('nav-flashcards').addEventListener('click', () => showView('view-flashcards'));
            document.getElementById('nav-quiz').addEventListener('click', () => showView('view-quiz'));

            // Home screen buttons
            document.getElementById('home-start-flashcards').addEventListener('click', () => {
                showView('view-flashcards');
                initFlashcards(); // Re-initialize flashcards when starting from home
            });
            document.getElementById('home-start-quiz').addEventListener('click', () => {
                showView('view-quiz');
                initQuiz(); // Re-initialize quiz when starting from home
                startQuiz();
            });

            // Flashcard controls
            document.querySelector('#flashcard-display .flashcard').addEventListener('click', flipFlashcard);
            document.getElementById('flashcard-next').addEventListener('click', nextFlashcard);
            document.getElementById('flashcard-prev').addEventListener('click', prevFlashcard);

            // Quiz controls
            document.getElementById('quiz-start-button').addEventListener('click', startQuiz);
            document.getElementById('quiz-next-button').addEventListener('click', nextQuizQuestion);
            document.getElementById('quiz-restart-button').addEventListener('click', restartQuiz);

            // Initial view
            showView('view-home');
        });
    </script>
</body>
</html>
